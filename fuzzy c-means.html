
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tuas 8 : Fuzzy c-means &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fuzzy c-means';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tugas Deploy Aplikasi" href="deploy.html" />
    <link rel="prev" title="tahap evaluasi model" href="tugas6new.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tugas1shot.html">Tugas 1 : Crawling Web Berita tempo.co</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tugas2prepocessing.html">Tugas 02 : Membuat VSM dengan Bobot TFID</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tugas3shoot.html">Tugas 3 : Implementasi Algoritma Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ringkasan_Berita.html">Tugas 4 : meringkas tugas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tugas_5.html">Tugas 5 : meringkas satu berita</a></li>
<li class="toctree-l1"><a class="reference internal" href="keyword.html">Tuagas 6 ( UTS ) : Keyword extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tugas6new.html">tahap evaluasi model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tuas 8 : Fuzzy c-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Tugas Deploy Aplikasi</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/docs/fuzzy c-means.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ffuzzy c-means.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/fuzzy c-means.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tuas 8 : Fuzzy c-means</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#menerapkan-vektorisasi-tf-idf">Menerapkan Vektorisasi TF-IDF :</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mencari-jumlah-komponen-terbaik-n-components">mencari jumlah komponen terbaik (n_components)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-c-means-clustering">Fuzzy C-Means Clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi">Visualisasi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#penyimpanan-hasil">Penyimpanan Hasil</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tuas-8-fuzzy-c-means">
<h1>Tuas 8 : Fuzzy c-means<a class="headerlink" href="#tuas-8-fuzzy-c-means" title="Link to this heading">#</a></h1>
<p>code berikut bertujuan untuk menerapkan algoritme klasterisasi Fuzzy C-Means (FCM) pada data berbasis teks. Dimulai dengan memuat data dari sumber eksternal, notebook ini mengimpor pustaka penting seperti Pandas, NumPy, dan Scikit-learn. Data yang dimuat kemudian melalui tahap preprocessing, termasuk encoding data kategorik menggunakan LabelEncoder dan pembersihan teks seperti penghapusan stopword. Selanjutnya, teks diubah menjadi representasi numerik menggunakan TF-IDF untuk menghasilkan matriks fitur. Untuk menyederhanakan analisis, dilakukan reduksi dimensi menggunakan Truncated SVD.</p>
<p>Algoritme FCM diterapkan untuk mengelompokkan data ke dalam beberapa klaster, dengan jumlah klaster optimal ditentukan berdasarkan metrik evaluasi seperti silhouette score. Evaluasi klasterisasi dilakukan menggunakan metrik seperti Adjusted Rand Index (ARI), Silhouette Score, dan Normalized Mutual Information (NMI). Hasil klasterisasi divisualisasikan menggunakan Matplotlib dan Seaborn untuk memahami distribusi data dan kualitas klaster. Akhirnya, model FCM beserta hasil klasterisasi disimpan ke file untuk penggunaan di masa depan. Notebook ini menghasilkan model klasterisasi yang terlatih, visualisasi hasil, dan file berisi label klaster untuk setiap data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
<span class="c1"># Import the pandas library and alias it as pd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-1-7dc37fdd45a7&gt;</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Import the pandas library and alias it as pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/google/colab/drive.py</span> in <span class="ni">mount</span><span class="nt">(mountpoint, force_remount, timeout_ms, readonly)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">def</span> <span class="nf">mount</span><span class="p">(</span><span class="n">mountpoint</span><span class="p">,</span> <span class="n">force_remount</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout_ms</span><span class="o">=</span><span class="mi">120000</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span><span class="w">   </span><span class="sd">&quot;&quot;&quot;Mount your Google Drive at the specified mountpoint path.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">100</span>   <span class="k">return</span> <span class="n">_mount</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span>       <span class="n">mountpoint</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span>       <span class="n">force_remount</span><span class="o">=</span><span class="n">force_remount</span><span class="p">,</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/google/colab/drive.py</span> in <span class="ni">_mount</span><span class="nt">(mountpoint, force_remount, timeout_ms, ephemeral, readonly)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>   <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>   <span class="k">if</span> <span class="n">ephemeral</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="n">_message</span><span class="o">.</span><span class="n">blocking_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>         <span class="s1">&#39;request_auth&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>         <span class="n">request</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;authType&#39;</span><span class="p">:</span> <span class="s1">&#39;dfs_ephemeral&#39;</span><span class="p">},</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/google/colab/_message.py</span> in <span class="ni">blocking_request</span><span class="nt">(request_type, request, timeout_sec, parent)</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>       <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">expect_reply</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>   <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">176</span>   <span class="k">return</span> <span class="n">read_reply_from_input</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="p">)</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/google/colab/_message.py</span> in <span class="ni">read_reply_from_input</span><span class="nt">(message_id, timeout_sec)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span>     <span class="n">reply</span> <span class="o">=</span> <span class="n">_read_next_input_message</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>     <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">_NOT_READY</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reply</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">96</span>       <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>       <span class="k">continue</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>     <span class="k">if</span> <span class="p">(</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ganti path dengan lokasi file di Google Drive Anda</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/ppw/tugas/DataTugas2/Hasil_Prepros.csv&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="c1"># Now pd is defined and can be used</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bb250353-6154-43e7-b262-1f8214d8122e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Judul Berita</th>
      <th>Isi Berita</th>
      <th>Tanggal Berita</th>
      <th>Kategori Berita</th>
      <th>cleansing</th>
      <th>case_folding</th>
      <th>tokenize</th>
      <th>stopword_removal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pesan Anies ke Tom Lembong Tersangka Korupsi I...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>30-10-2024 05:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>reporter\nnovali panji nugroho\neditor\neko ar...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor eko ari w...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom Lembong Tersangka Korupsi Impor Gula, Nama...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 23:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Profil Tom Lembong, Eks Mendag dan Co-Captain ...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 22:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom Lembong Sempat Unggah Hal Ini Sehari Sebel...</td>
      <td>Reporter\nTempo.co\nEditor\nAndry Triyanto Tji...</td>
      <td>30-10-2024 02:55</td>
      <td>Nasional</td>
      <td>Reporter\nTempoco\nEditor\nAndry Triyanto Tjit...</td>
      <td>reporter\ntempoco\neditor\nandry triyanto tjit...</td>
      <td>['reporter', 'tempoco', 'editor', 'andry', 'tr...</td>
      <td>reporter tempoco editor andry triyanto tjitra ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prabowo Ingin Tingkatkan Pembangunan di Papua,...</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>29-10-2024 23:55</td>
      <td>Bisnis</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>reporter\nvedro imanuel g\neditor\nagung seday...</td>
      <td>['reporter', 'vedro', 'imanuel', 'g', 'editor'...</td>
      <td>reporter vedro imanuel g editor agung sedayu r...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Kementan Berencana Datangkan Sapi Hidup Ke Ind...</td>
      <td>Reporter\nM. Raihan Muzzaki\nEditor\nAisha Sha...</td>
      <td>30-10-2024 00:58</td>
      <td>Bisnis</td>
      <td>Reporter\nM Raihan Muzzaki\nEditor\nAisha Shai...</td>
      <td>reporter\nm raihan muzzaki\neditor\naisha shai...</td>
      <td>['reporter', 'm', 'raihan', 'muzzaki', 'editor...</td>
      <td>reporter m raihan muzzaki editor aisha shaidra...</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Profil Charles Sitorus, Tersangka dalam Kasus ...</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr. Ariyani Y...</td>
      <td>30-10-2024 02:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr Ariyani Ya...</td>
      <td>reporter\nadil al hasan\neditor\nrr ariyani ya...</td>
      <td>['reporter', 'adil', 'al', 'hasan', 'editor', ...</td>
      <td>reporter adil al hasan editor rr ariyani yakti...</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Bisik-bisik Prabowo kepada Fahri Hamzah Wakil ...</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS. Dian...</td>
      <td>30-10-2024 03:58</td>
      <td>Bisnis</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS Dian ...</td>
      <td>reporter\nsukma kanthi nurani\neditor\ns dian ...</td>
      <td>['reporter', 'sukma', 'kanthi', 'nurani', 'edi...</td>
      <td>reporter sukma kanthi nurani editor s dian and...</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Tom Lembong Jadi Tersangka, Ini Kata Anies, Mu...</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu,...</td>
      <td>30-10-2024 10:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu ...</td>
      <td>reporter\nantara\neditor\nyudono yanuar\nrabu ...</td>
      <td>['reporter', 'antara', 'editor', 'yudono', 'ya...</td>
      <td>reporter editor yudono yanuar rabu oktober wib...</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Kejagung Tetapkan Tom Lembong Tersangka Impor ...</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS. D...</td>
      <td>30-10-2024 13:58</td>
      <td>Bisnis</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS Di...</td>
      <td>reporter\nrachel farahdiba regar\neditor\ns di...</td>
      <td>['reporter', 'rachel', 'farahdiba', 'regar', '...</td>
      <td>reporter rachel farahdiba regar editor s dian ...</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 8 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bb250353-6154-43e7-b262-1f8214d8122e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bb250353-6154-43e7-b262-1f8214d8122e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bb250353-6154-43e7-b262-1f8214d8122e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-306ea84d-ad3a-4c8a-a40e-0a3a69c34990">
  <button class="colab-df-quickchart" onclick="quickchart('df-306ea84d-ad3a-4c8a-a40e-0a3a69c34990')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-306ea84d-ad3a-4c8a-a40e-0a3a69c34990 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_6db50d45-a9f2-46ff-a1e9-b2607748583b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6db50d45-a9f2-46ff-a1e9-b2607748583b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('data');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Transformasi data kategorik</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;kategori_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Kategori Berita&#39;</span><span class="p">])</span>

<span class="c1"># Menampilkan nilai sebelum dan sesudah konversi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nilai sebelum dan sesudah konversi:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">))))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame setelah Label Encoding:&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nilai sebelum dan sesudah konversi:
{&#39;Bisnis&#39;: 0, &#39;Nasional&#39;: 1}

DataFrame setelah Label Encoding:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-13eead2a-eac2-4481-8218-b2e76332f177" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Judul Berita</th>
      <th>Isi Berita</th>
      <th>Tanggal Berita</th>
      <th>Kategori Berita</th>
      <th>cleansing</th>
      <th>case_folding</th>
      <th>tokenize</th>
      <th>stopword_removal</th>
      <th>kategori_encoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pesan Anies ke Tom Lembong Tersangka Korupsi I...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>30-10-2024 05:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>reporter\nnovali panji nugroho\neditor\neko ar...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor eko ari w...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom Lembong Tersangka Korupsi Impor Gula, Nama...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 23:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Profil Tom Lembong, Eks Mendag dan Co-Captain ...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 22:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom Lembong Sempat Unggah Hal Ini Sehari Sebel...</td>
      <td>Reporter\nTempo.co\nEditor\nAndry Triyanto Tji...</td>
      <td>30-10-2024 02:55</td>
      <td>Nasional</td>
      <td>Reporter\nTempoco\nEditor\nAndry Triyanto Tjit...</td>
      <td>reporter\ntempoco\neditor\nandry triyanto tjit...</td>
      <td>['reporter', 'tempoco', 'editor', 'andry', 'tr...</td>
      <td>reporter tempoco editor andry triyanto tjitra ...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prabowo Ingin Tingkatkan Pembangunan di Papua,...</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>29-10-2024 23:55</td>
      <td>Bisnis</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>reporter\nvedro imanuel g\neditor\nagung seday...</td>
      <td>['reporter', 'vedro', 'imanuel', 'g', 'editor'...</td>
      <td>reporter vedro imanuel g editor agung sedayu r...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Kementan Berencana Datangkan Sapi Hidup Ke Ind...</td>
      <td>Reporter\nM. Raihan Muzzaki\nEditor\nAisha Sha...</td>
      <td>30-10-2024 00:58</td>
      <td>Bisnis</td>
      <td>Reporter\nM Raihan Muzzaki\nEditor\nAisha Shai...</td>
      <td>reporter\nm raihan muzzaki\neditor\naisha shai...</td>
      <td>['reporter', 'm', 'raihan', 'muzzaki', 'editor...</td>
      <td>reporter m raihan muzzaki editor aisha shaidra...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Profil Charles Sitorus, Tersangka dalam Kasus ...</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr. Ariyani Y...</td>
      <td>30-10-2024 02:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr Ariyani Ya...</td>
      <td>reporter\nadil al hasan\neditor\nrr ariyani ya...</td>
      <td>['reporter', 'adil', 'al', 'hasan', 'editor', ...</td>
      <td>reporter adil al hasan editor rr ariyani yakti...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Bisik-bisik Prabowo kepada Fahri Hamzah Wakil ...</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS. Dian...</td>
      <td>30-10-2024 03:58</td>
      <td>Bisnis</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS Dian ...</td>
      <td>reporter\nsukma kanthi nurani\neditor\ns dian ...</td>
      <td>['reporter', 'sukma', 'kanthi', 'nurani', 'edi...</td>
      <td>reporter sukma kanthi nurani editor s dian and...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Tom Lembong Jadi Tersangka, Ini Kata Anies, Mu...</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu,...</td>
      <td>30-10-2024 10:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu ...</td>
      <td>reporter\nantara\neditor\nyudono yanuar\nrabu ...</td>
      <td>['reporter', 'antara', 'editor', 'yudono', 'ya...</td>
      <td>reporter editor yudono yanuar rabu oktober wib...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Kejagung Tetapkan Tom Lembong Tersangka Impor ...</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS. D...</td>
      <td>30-10-2024 13:58</td>
      <td>Bisnis</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS Di...</td>
      <td>reporter\nrachel farahdiba regar\neditor\ns di...</td>
      <td>['reporter', 'rachel', 'farahdiba', 'regar', '...</td>
      <td>reporter rachel farahdiba regar editor s dian ...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-13eead2a-eac2-4481-8218-b2e76332f177')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-13eead2a-eac2-4481-8218-b2e76332f177 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-13eead2a-eac2-4481-8218-b2e76332f177');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-195182c0-6be9-4771-b434-a80fc777c851">
  <button class="colab-df-quickchart" onclick="quickchart('df-195182c0-6be9-4771-b434-a80fc777c851')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-195182c0-6be9-4771-b434-a80fc777c851 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_0147c0d2-cbf0-43e8-bd99-cfb08fdf94c4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0147c0d2-cbf0-43e8-bd99-cfb08fdf94c4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('data');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p>di atas adalah proses encode dari nilai kategori berita
sebelum dan sesudah konversi:</p>
<p>{‘Bisnis’: 0, ‘Nasional’: 1}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">category_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Bisnis&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;Nasional&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;kategori_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Kategori Berita&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">category_mapping</span><span class="p">)</span>

<span class="c1"># Save  dataset</span>
<span class="n">output_file_path</span> <span class="o">=</span> <span class="s1">&#39;kategori_encoded_data.csv&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File berhasil simpan&quot;</span><span class="p">)</span>
<span class="n">output_file_path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File berhasil simpan
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;kategori_encoded_data.csv&#39;
</pre></div>
</div>
</div>
</div>
<section id="menerapkan-vektorisasi-tf-idf">
<h2>Menerapkan Vektorisasi TF-IDF :<a class="headerlink" href="#menerapkan-vektorisasi-tf-idf" title="Link to this heading">#</a></h2>
<p>Kode berikut mengambil teks dari kolom <code class="docutils literal notranslate"><span class="pre">stopword_removal</span></code> pada dataset, menghapus nilai kosong, dan melakukan vektorisasi menggunakan metode TF-IDF untuk menghasilkan bobot kata berdasarkan frekuensi relatif dan <em>inverse document frequency</em>. Matriks hasil TF-IDF kemudian dinormalisasi menggunakan <em>StandardScaler</em> untuk menstandarkan data dengan rata-rata 0 dan standar deviasi 1. Nama fitur (kata unik) yang dihasilkan diekstraksi, dan matriks TF-IDF dikonversi menjadi DataFrame untuk mempermudah analisis. Hasil akhir disimpan dalam file CSV bernama <code class="docutils literal notranslate"><span class="pre">tf-idf.csv</span></code>, dan dimensi matriks TF-IDF diperiksa untuk mengetahui jumlah dokumen dan kata unik.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">texts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vektorisasi TF-IDF</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>


<span class="c1"># Assuming &#39;texts&#39; is your pandas Series containing text data</span>
<span class="c1"># Drop rows with missing values in &#39;texts&#39; column</span>
<span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">tfidf_vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">tfidf_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
<span class="n">X_tfidf</span> <span class="o">=</span> <span class="n">tfidf_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tfidf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mendapatkan nama fitur dari TF-IDF</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">tfidf_vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>

<span class="c1"># Konversi TF-IDF hasil training ke DataFrame</span>
<span class="n">df_train_tfidf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tfidf_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df_train_tfidf</span>
<span class="n">df_train_tfidf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;tf-idf.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_tfidf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(99, 1744)
</pre></div>
</div>
</div>
</div>
</section>
<section id="mencari-jumlah-komponen-terbaik-n-components">
<h2>mencari jumlah komponen terbaik (n_components)<a class="headerlink" href="#mencari-jumlah-komponen-terbaik-n-components" title="Link to this heading">#</a></h2>
<p>kode berikut untuk mencari jumlah komponen terbaik (n_components) dalam reduksi dimensi menggunakan TruncatedSVD dan mengevaluasi hasil clustering menggunakan Fuzzy C-Means (FCM) dengan mengukur kualitas clustering berdasarkan tiga metrik utama: Silhouette Score, Adjusted Rand Index (ARI), dan Normalized Mutual Information (NMI). yang ber tujuan untuk mencari kombinasi yang optimal antara jumlah komponen dalam reduksi dimensi dan kualitas hasil clustering yang sesuai dengan label asli data.</p>
</section>
<section id="fuzzy-c-means-clustering">
<h2>Fuzzy C-Means Clustering<a class="headerlink" href="#fuzzy-c-means-clustering" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>fuzzy-c-means
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: fuzzy-c-means in /usr/local/lib/python3.10/dist-packages (1.7.2)
Requirement already satisfied: joblib&lt;2.0.0,&gt;=1.2.0 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (1.4.2)
Requirement already satisfied: numpy&lt;2.0.0,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (1.26.4)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.6.4 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (2.10.3)
Requirement already satisfied: tabulate&lt;0.9.0,&gt;=0.8.9 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (0.8.10)
Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.64.1 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (4.67.1)
Requirement already satisfied: typer&lt;0.10.0,&gt;=0.9.0 in /usr/local/lib/python3.10/dist-packages (from fuzzy-c-means) (0.9.4)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.10/dist-packages (from pydantic&lt;3.0.0,&gt;=2.6.4-&gt;fuzzy-c-means) (0.7.0)
Requirement already satisfied: pydantic-core==2.27.1 in /usr/local/lib/python3.10/dist-packages (from pydantic&lt;3.0.0,&gt;=2.6.4-&gt;fuzzy-c-means) (2.27.1)
Requirement already satisfied: typing-extensions&gt;=4.12.2 in /usr/local/lib/python3.10/dist-packages (from pydantic&lt;3.0.0,&gt;=2.6.4-&gt;fuzzy-c-means) (4.12.2)
Requirement already satisfied: click&lt;9.0.0,&gt;=7.1.1 in /usr/local/lib/python3.10/dist-packages (from typer&lt;0.10.0,&gt;=0.9.0-&gt;fuzzy-c-means) (8.1.7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">adjusted_rand_score</span><span class="p">,</span> <span class="n">normalized_mutual_info_score</span><span class="p">,</span> <span class="n">silhouette_score</span>  <span class="c1"># Impor silhouette_score</span>
<span class="kn">from</span> <span class="nn">fcmeans</span> <span class="kn">import</span> <span class="n">FCM</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Pastikan X_scaled sudah terdefinisi sebelumnya</span>

<span class="c1"># Inisialisasi variabel untuk menyimpan hasil</span>
<span class="n">best_silhouette</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">best_ari</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">best_nmi</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">best_n_components</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Asumsikan y_true adalah label asli dari dataset Anda</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;kategori_encoded&#39;</span><span class="p">]</span>  <span class="c1"># Ganti &#39;kategori&#39; dengan nama kolom label asli</span>

<span class="c1"># Mendapatkan indeks baris yang digunakan dalam X_scaled</span>
<span class="c1"># Asumsi: Anda sudah menghapus baris dengan nilai kosong di &#39;texts&#39; sebelum membuat X_scaled</span>
<span class="n">valid_indices</span> <span class="o">=</span> <span class="n">texts</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Filter y_true agar ukurannya sesuai dengan X_scaled</span>
<span class="n">y_true_filtered</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>  <span class="c1"># Rentang nilai n_components</span>
    <span class="c1"># Reduksi dimensi menggunakan TruncatedSVD</span>
    <span class="n">svd</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">data_reduced</span> <span class="o">=</span> <span class="n">svd</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>

    <span class="c1"># Fuzzy C-Means Clustering</span>
    <span class="n">fcm</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="c1"># m= jarak kedekatan antara cluster</span>
    <span class="n">fcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_reduced</span><span class="p">)</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_reduced</span><span class="p">)</span>

    <span class="c1"># Evaluasi dengan Silhouette Score, ARI, dan NMI</span>
    <span class="n">silhouette</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">data_reduced</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

    <span class="c1"># Gunakan y_true yang sudah difilter untuk menghitung adjusted_rand_score</span>
    <span class="n">ari</span> <span class="o">=</span> <span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">y_true_filtered</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

    <span class="n">nmi</span> <span class="o">=</span> <span class="n">normalized_mutual_info_score</span><span class="p">(</span><span class="n">y_true_filtered</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

    <span class="c1"># Simpan hasil evaluasi dalam dictionary results</span>
    <span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;silhouette&#39;</span><span class="p">:</span> <span class="n">silhouette</span><span class="p">,</span>
        <span class="s1">&#39;ari&#39;</span><span class="p">:</span> <span class="n">ari</span><span class="p">,</span>
        <span class="s1">&#39;nmi&#39;</span><span class="p">:</span> <span class="n">nmi</span>
    <span class="p">}</span>

    <span class="c1"># Log hasil setiap iterasi</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iterasi dengan n_components=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: Silhouette=</span><span class="si">{</span><span class="n">silhouette</span><span class="si">}</span><span class="s2">, ARI=</span><span class="si">{</span><span class="n">ari</span><span class="si">}</span><span class="s2">, NMI=</span><span class="si">{</span><span class="n">nmi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Perbarui nilai terbaik</span>
    <span class="k">if</span> <span class="n">silhouette</span> <span class="o">&gt;</span> <span class="n">best_silhouette</span><span class="p">:</span>
        <span class="n">best_silhouette</span> <span class="o">=</span> <span class="n">silhouette</span>
        <span class="n">best_n_components</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">if</span> <span class="n">ari</span> <span class="o">&gt;</span> <span class="n">best_ari</span><span class="p">:</span>
        <span class="n">best_ari</span> <span class="o">=</span> <span class="n">ari</span>
    <span class="k">if</span> <span class="n">nmi</span> <span class="o">&gt;</span> <span class="n">best_nmi</span><span class="p">:</span>
        <span class="n">best_nmi</span> <span class="o">=</span> <span class="n">nmi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iterasi dengan n_components=2: Silhouette=0.49418730089228674, ARI=-0.007553863963821406, NMI=0.001985708267967615
Iterasi dengan n_components=3: Silhouette=0.44759627539838964, ARI=-0.007553863963821406, NMI=0.001985708267967615
Iterasi dengan n_components=4: Silhouette=0.3276829496290099, ARI=-0.007721718269735362, NMI=0.0018210073067904207
Iterasi dengan n_components=5: Silhouette=0.2683529622488039, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=6: Silhouette=0.2372758834309032, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=7: Silhouette=0.2152002715139566, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=8: Silhouette=0.20120253368123725, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=9: Silhouette=0.18452956910998636, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=10: Silhouette=0.15995544981844922, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=11: Silhouette=0.13693293292482306, ARI=-0.007428009926219543, NMI=0.0020518816023631253
Iterasi dengan n_components=12: Silhouette=0.12397726165607316, ARI=-0.007428009926219543, NMI=0.0020518816023631253
Iterasi dengan n_components=13: Silhouette=0.11962237835838621, ARI=-0.010077874484654145, NMI=5.915166197047253e-05
Iterasi dengan n_components=14: Silhouette=0.12535836488362714, ARI=-0.007553863963821406, NMI=0.001985708267967615
Iterasi dengan n_components=15: Silhouette=0.11810389369074807, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=16: Silhouette=0.11805396802841804, ARI=-0.007679749450256547, NMI=0.0018014755451583296
Iterasi dengan n_components=17: Silhouette=0.11714229176443879, ARI=0.012894519829072644, NMI=0.01671590222206856
Iterasi dengan n_components=18: Silhouette=0.12234445722088307, ARI=0.028289566714633882, NMI=0.03162993786183313
Iterasi dengan n_components=19: Silhouette=0.10364179279938512, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=20: Silhouette=0.10364179299574755, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=21: Silhouette=0.10364179306800964, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=22: Silhouette=0.10364179308077393, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=23: Silhouette=0.10364179303014752, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=24: Silhouette=0.10364179298984687, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=25: Silhouette=0.10364179287251549, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=26: Silhouette=0.10364179301048146, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=27: Silhouette=0.10364179290046216, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=28: Silhouette=0.10364179291789295, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=29: Silhouette=0.10364179318514131, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=30: Silhouette=0.10364179308182177, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=31: Silhouette=0.10364179296588062, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=32: Silhouette=0.10364179314515184, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=33: Silhouette=0.10364179292605998, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=34: Silhouette=0.10364179305348582, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=35: Silhouette=0.10364179305388974, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=36: Silhouette=0.10364179320031867, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=37: Silhouette=0.10364179290314667, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=38: Silhouette=0.10364179290831037, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=39: Silhouette=0.1036417929860471, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=40: Silhouette=0.10364179319532756, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=41: Silhouette=0.10364179283865708, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=42: Silhouette=0.10364179296293273, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=43: Silhouette=0.10364179308884135, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=44: Silhouette=0.10364179295896137, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=45: Silhouette=0.10364179298443285, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=46: Silhouette=0.10364179315399259, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=47: Silhouette=0.10364179320562392, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=48: Silhouette=0.10364179294301222, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=49: Silhouette=0.1036417930837311, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=50: Silhouette=0.10364179282055226, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=51: Silhouette=0.10364179303939866, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=52: Silhouette=0.10364179295990215, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=53: Silhouette=0.10364179278574577, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=54: Silhouette=0.10364179308908474, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=55: Silhouette=0.10364179309978365, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=56: Silhouette=0.10364179299828498, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=57: Silhouette=0.1036417929718925, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=58: Silhouette=0.10364179317312695, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=59: Silhouette=0.10364179293367014, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=60: Silhouette=0.10364179276453896, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=61: Silhouette=0.10364179300247779, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=62: Silhouette=0.10364179309535193, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=63: Silhouette=0.10364179293565706, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=64: Silhouette=0.10364179316945761, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=65: Silhouette=0.10364179289673084, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=66: Silhouette=0.10364179295059615, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=67: Silhouette=0.10364179286787405, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=68: Silhouette=0.10364179309112244, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=69: Silhouette=0.10364179289536363, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=70: Silhouette=0.10364179310416641, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=71: Silhouette=0.10364179282663452, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=72: Silhouette=0.10364179311393923, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=73: Silhouette=0.10364179305427908, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=74: Silhouette=0.10364179293191761, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=75: Silhouette=0.10364179279533244, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=76: Silhouette=0.10364179299349371, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=77: Silhouette=0.10364179281788656, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=78: Silhouette=0.10364179310323318, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=79: Silhouette=0.10364179298345291, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=80: Silhouette=0.10364179294841186, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=81: Silhouette=0.10364179286071797, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=82: Silhouette=0.10364179303649951, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=83: Silhouette=0.10364179283530339, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=84: Silhouette=0.10364179303141245, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=85: Silhouette=0.10364179302175772, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=86: Silhouette=0.10364179296033098, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=87: Silhouette=0.10364179298300258, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=88: Silhouette=0.10364179287387948, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=89: Silhouette=0.10364179296276893, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=90: Silhouette=0.10364179295135158, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=91: Silhouette=0.10364179275670703, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=92: Silhouette=0.10364179304461811, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=93: Silhouette=0.10364179304919578, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=94: Silhouette=0.10364179296950907, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=95: Silhouette=0.10364179305583403, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=96: Silhouette=0.1036417927808958, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=97: Silhouette=0.10364179295201117, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=98: Silhouette=0.10364179297542249, ARI=0.03638012362420239, NMI=0.03805533927506222
Iterasi dengan n_components=99: Silhouette=0.1036417930645575, ARI=0.03638012362420239, NMI=0.03805533927506222
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menyimpan hasil terbaik untuk setiap metrik</span>
<span class="n">best_silhouette_n_components</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;silhouette&#39;</span><span class="p">])</span>
<span class="n">best_ari_n_components</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;ari&#39;</span><span class="p">])</span>
<span class="n">best_nmi_n_components</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;nmi&#39;</span><span class="p">])</span>

<span class="c1"># Menampilkan hasil terbaik</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nilai Silhouette terbaik dicapai oleh n_components=</span><span class="si">{</span><span class="n">best_silhouette_n_components</span><span class="si">}</span><span class="s2"> dengan skor: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="n">best_silhouette_n_components</span><span class="p">][</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nilai ARI terbaik dicapai oleh n_components=</span><span class="si">{</span><span class="n">best_ari_n_components</span><span class="si">}</span><span class="s2"> dengan skor: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="n">best_ari_n_components</span><span class="p">][</span><span class="s1">&#39;ari&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nilai NMI terbaik dicapai oleh n_components=</span><span class="si">{</span><span class="n">best_nmi_n_components</span><span class="si">}</span><span class="s2"> dengan skor: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="n">best_nmi_n_components</span><span class="p">][</span><span class="s1">&#39;nmi&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nilai Silhouette terbaik dicapai oleh n_components=2 dengan skor: 0.49418730089228674
Nilai ARI terbaik dicapai oleh n_components=19 dengan skor: 0.03638012362420239
Nilai NMI terbaik dicapai oleh n_components=19 dengan skor: 0.03805533927506222
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mengurutkan hasil berdasarkan silhouette score (dari tertinggi ke terendah)</span>
<span class="n">sorted_results</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;silhouette&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil akhir</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">n_components Terbaik: </span><span class="si">{</span><span class="n">best_n_components</span><span class="si">}</span><span class="s2"> dengan silhouette score: </span><span class="si">{</span><span class="n">best_silhouette</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Semua hasil (diurutkan berdasarkan silhouette score):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">sorted_results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_components=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: Silhouette Score=</span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n_components Terbaik: 2 dengan silhouette score: 0.49418730089228674

Semua hasil (diurutkan berdasarkan silhouette score):
n_components=2: Silhouette Score={&#39;silhouette&#39;: 0.49418730089228674, &#39;ari&#39;: -0.007553863963821406, &#39;nmi&#39;: 0.001985708267967615}
n_components=3: Silhouette Score={&#39;silhouette&#39;: 0.44759627539838964, &#39;ari&#39;: -0.007553863963821406, &#39;nmi&#39;: 0.001985708267967615}
n_components=4: Silhouette Score={&#39;silhouette&#39;: 0.3276829496290099, &#39;ari&#39;: -0.007721718269735362, &#39;nmi&#39;: 0.0018210073067904207}
n_components=5: Silhouette Score={&#39;silhouette&#39;: 0.2683529622488039, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=6: Silhouette Score={&#39;silhouette&#39;: 0.2372758834309032, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=7: Silhouette Score={&#39;silhouette&#39;: 0.2152002715139566, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=8: Silhouette Score={&#39;silhouette&#39;: 0.20120253368123725, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=9: Silhouette Score={&#39;silhouette&#39;: 0.18452956910998636, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=10: Silhouette Score={&#39;silhouette&#39;: 0.15995544981844922, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=11: Silhouette Score={&#39;silhouette&#39;: 0.13693293292482306, &#39;ari&#39;: -0.007428009926219543, &#39;nmi&#39;: 0.0020518816023631253}
n_components=14: Silhouette Score={&#39;silhouette&#39;: 0.12535836488362714, &#39;ari&#39;: -0.007553863963821406, &#39;nmi&#39;: 0.001985708267967615}
n_components=12: Silhouette Score={&#39;silhouette&#39;: 0.12397726165607316, &#39;ari&#39;: -0.007428009926219543, &#39;nmi&#39;: 0.0020518816023631253}
n_components=18: Silhouette Score={&#39;silhouette&#39;: 0.12234445722088307, &#39;ari&#39;: 0.028289566714633882, &#39;nmi&#39;: 0.03162993786183313}
n_components=13: Silhouette Score={&#39;silhouette&#39;: 0.11962237835838621, &#39;ari&#39;: -0.010077874484654145, &#39;nmi&#39;: 5.915166197047253e-05}
n_components=15: Silhouette Score={&#39;silhouette&#39;: 0.11810389369074807, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=16: Silhouette Score={&#39;silhouette&#39;: 0.11805396802841804, &#39;ari&#39;: -0.007679749450256547, &#39;nmi&#39;: 0.0018014755451583296}
n_components=17: Silhouette Score={&#39;silhouette&#39;: 0.11714229176443879, &#39;ari&#39;: 0.012894519829072644, &#39;nmi&#39;: 0.01671590222206856}
n_components=47: Silhouette Score={&#39;silhouette&#39;: 0.10364179320562392, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=36: Silhouette Score={&#39;silhouette&#39;: 0.10364179320031867, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=40: Silhouette Score={&#39;silhouette&#39;: 0.10364179319532756, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=29: Silhouette Score={&#39;silhouette&#39;: 0.10364179318514131, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=58: Silhouette Score={&#39;silhouette&#39;: 0.10364179317312695, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=64: Silhouette Score={&#39;silhouette&#39;: 0.10364179316945761, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=46: Silhouette Score={&#39;silhouette&#39;: 0.10364179315399259, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=32: Silhouette Score={&#39;silhouette&#39;: 0.10364179314515184, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=72: Silhouette Score={&#39;silhouette&#39;: 0.10364179311393923, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=70: Silhouette Score={&#39;silhouette&#39;: 0.10364179310416641, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=78: Silhouette Score={&#39;silhouette&#39;: 0.10364179310323318, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=55: Silhouette Score={&#39;silhouette&#39;: 0.10364179309978365, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=62: Silhouette Score={&#39;silhouette&#39;: 0.10364179309535193, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=68: Silhouette Score={&#39;silhouette&#39;: 0.10364179309112244, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=54: Silhouette Score={&#39;silhouette&#39;: 0.10364179308908474, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=43: Silhouette Score={&#39;silhouette&#39;: 0.10364179308884135, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=49: Silhouette Score={&#39;silhouette&#39;: 0.1036417930837311, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=30: Silhouette Score={&#39;silhouette&#39;: 0.10364179308182177, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=22: Silhouette Score={&#39;silhouette&#39;: 0.10364179308077393, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=21: Silhouette Score={&#39;silhouette&#39;: 0.10364179306800964, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=99: Silhouette Score={&#39;silhouette&#39;: 0.1036417930645575, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=95: Silhouette Score={&#39;silhouette&#39;: 0.10364179305583403, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=73: Silhouette Score={&#39;silhouette&#39;: 0.10364179305427908, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=35: Silhouette Score={&#39;silhouette&#39;: 0.10364179305388974, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=34: Silhouette Score={&#39;silhouette&#39;: 0.10364179305348582, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=93: Silhouette Score={&#39;silhouette&#39;: 0.10364179304919578, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=92: Silhouette Score={&#39;silhouette&#39;: 0.10364179304461811, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=51: Silhouette Score={&#39;silhouette&#39;: 0.10364179303939866, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=82: Silhouette Score={&#39;silhouette&#39;: 0.10364179303649951, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=84: Silhouette Score={&#39;silhouette&#39;: 0.10364179303141245, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=23: Silhouette Score={&#39;silhouette&#39;: 0.10364179303014752, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=85: Silhouette Score={&#39;silhouette&#39;: 0.10364179302175772, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=26: Silhouette Score={&#39;silhouette&#39;: 0.10364179301048146, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=61: Silhouette Score={&#39;silhouette&#39;: 0.10364179300247779, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=56: Silhouette Score={&#39;silhouette&#39;: 0.10364179299828498, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=20: Silhouette Score={&#39;silhouette&#39;: 0.10364179299574755, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=76: Silhouette Score={&#39;silhouette&#39;: 0.10364179299349371, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=24: Silhouette Score={&#39;silhouette&#39;: 0.10364179298984687, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=39: Silhouette Score={&#39;silhouette&#39;: 0.1036417929860471, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=45: Silhouette Score={&#39;silhouette&#39;: 0.10364179298443285, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=79: Silhouette Score={&#39;silhouette&#39;: 0.10364179298345291, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=87: Silhouette Score={&#39;silhouette&#39;: 0.10364179298300258, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=98: Silhouette Score={&#39;silhouette&#39;: 0.10364179297542249, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=57: Silhouette Score={&#39;silhouette&#39;: 0.1036417929718925, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=94: Silhouette Score={&#39;silhouette&#39;: 0.10364179296950907, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=31: Silhouette Score={&#39;silhouette&#39;: 0.10364179296588062, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=42: Silhouette Score={&#39;silhouette&#39;: 0.10364179296293273, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=89: Silhouette Score={&#39;silhouette&#39;: 0.10364179296276893, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=86: Silhouette Score={&#39;silhouette&#39;: 0.10364179296033098, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=52: Silhouette Score={&#39;silhouette&#39;: 0.10364179295990215, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=44: Silhouette Score={&#39;silhouette&#39;: 0.10364179295896137, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=97: Silhouette Score={&#39;silhouette&#39;: 0.10364179295201117, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=90: Silhouette Score={&#39;silhouette&#39;: 0.10364179295135158, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=66: Silhouette Score={&#39;silhouette&#39;: 0.10364179295059615, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=80: Silhouette Score={&#39;silhouette&#39;: 0.10364179294841186, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=48: Silhouette Score={&#39;silhouette&#39;: 0.10364179294301222, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=63: Silhouette Score={&#39;silhouette&#39;: 0.10364179293565706, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=59: Silhouette Score={&#39;silhouette&#39;: 0.10364179293367014, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=74: Silhouette Score={&#39;silhouette&#39;: 0.10364179293191761, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=33: Silhouette Score={&#39;silhouette&#39;: 0.10364179292605998, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=28: Silhouette Score={&#39;silhouette&#39;: 0.10364179291789295, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=38: Silhouette Score={&#39;silhouette&#39;: 0.10364179290831037, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=37: Silhouette Score={&#39;silhouette&#39;: 0.10364179290314667, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=27: Silhouette Score={&#39;silhouette&#39;: 0.10364179290046216, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=65: Silhouette Score={&#39;silhouette&#39;: 0.10364179289673084, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=69: Silhouette Score={&#39;silhouette&#39;: 0.10364179289536363, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=88: Silhouette Score={&#39;silhouette&#39;: 0.10364179287387948, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=25: Silhouette Score={&#39;silhouette&#39;: 0.10364179287251549, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=67: Silhouette Score={&#39;silhouette&#39;: 0.10364179286787405, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=81: Silhouette Score={&#39;silhouette&#39;: 0.10364179286071797, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=41: Silhouette Score={&#39;silhouette&#39;: 0.10364179283865708, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=83: Silhouette Score={&#39;silhouette&#39;: 0.10364179283530339, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=71: Silhouette Score={&#39;silhouette&#39;: 0.10364179282663452, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=50: Silhouette Score={&#39;silhouette&#39;: 0.10364179282055226, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=77: Silhouette Score={&#39;silhouette&#39;: 0.10364179281788656, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=19: Silhouette Score={&#39;silhouette&#39;: 0.10364179279938512, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=75: Silhouette Score={&#39;silhouette&#39;: 0.10364179279533244, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=53: Silhouette Score={&#39;silhouette&#39;: 0.10364179278574577, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=96: Silhouette Score={&#39;silhouette&#39;: 0.1036417927808958, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=60: Silhouette Score={&#39;silhouette&#39;: 0.10364179276453896, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
n_components=91: Silhouette Score={&#39;silhouette&#39;: 0.10364179275670703, &#39;ari&#39;: 0.03638012362420239, &#39;nmi&#39;: 0.03805533927506222}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Ambil data untuk plotting</span>
<span class="n">n_components_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sorted_results</span><span class="p">]</span>
<span class="n">silhouette_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">score</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">sorted_results</span><span class="p">]</span>

<span class="c1"># Membuat plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_components_list</span><span class="p">,</span> <span class="n">silhouette_scores</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Komponen (n_components)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Silhouette Score vs Jumlah Komponen&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">n_components_list</span><span class="p">)</span>  <span class="c1"># Tampilkan setiap nilai n_components pada sumbu x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b6469252769eaa12322e06d14af374b529b2a23cb78e68dda81f9b4a78213c41.png" src="_images/b6469252769eaa12322e06d14af374b529b2a23cb78e68dda81f9b4a78213c41.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Data untuk plotting</span>
<span class="n">n_components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">silhouette_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

<span class="c1"># Mengubah gaya plot dengan tema Seaborn</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;muted&quot;</span><span class="p">)</span>  <span class="c1"># Gunakan palet warna yang lebih jelas</span>

<span class="c1"># Membuat figure dengan ukuran lebih besar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot garis dengan gaya dan marker berbeda</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">silhouette_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Silhouette Score&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f77b4&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># Menambahkan grid horizontal dengan penyesuaian</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Menambahkan judul dan label dengan font yang lebih besar dan kontras</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Silhouette Score vs n_components&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#2ca02c&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Components (n_components)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Silhouette Score&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">)</span>

<span class="c1"># Menambahkan anotasi untuk nilai maksimum dengan penyesuaian warna dan posisi</span>
<span class="n">max_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">silhouette_scores</span><span class="p">)</span>
<span class="n">best_n</span> <span class="o">=</span> <span class="n">n_components</span><span class="p">[</span><span class="n">silhouette_scores</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">max_score</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best: </span><span class="si">{</span><span class="n">best_n</span><span class="si">}</span><span class="se">\n</span><span class="s2">Score: </span><span class="si">{</span><span class="n">max_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">best_n</span><span class="p">,</span> <span class="n">max_score</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">best_n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_score</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">),</span>
             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="c1"># Menambahkan legenda dengan gaya yang lebih modern</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Menampilkan grafik dengan layout yang lebih rapih</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Menampilkan grafik</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/665f9035b6efe1995e77e322e766e7e0d71566bf6b70fe03ed3c0ceeb1171258.png" src="_images/665f9035b6efe1995e77e322e766e7e0d71566bf6b70fe03ed3c0ceeb1171258.png" />
</div>
</div>
</section>
<section id="visualisasi">
<h2>Visualisasi<a class="headerlink" href="#visualisasi" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fcmeans</span> <span class="kn">import</span> <span class="n">FCM</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Untuk manipulasi DataFrame</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>

<span class="c1"># Membaca data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;kategori_encoded_data.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Mengganti NaN dengan string kosong</span>
<span class="n">texts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span>

<span class="c1"># Step 2: Vektorisasi TF-IDF</span>
<span class="n">tfidf_vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">tfidf_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">tfidf_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="c1"># Step 3 Normalisasi Hasil TF-IDF</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">data_normalisasi</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">tfidf</span><span class="p">)</span>

<span class="c1"># Step 4: Reduksi dimensi menggunakan SVD</span>
<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1"># Tetapkan seed untuk konsistensi</span>
<span class="n">svd</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">data_cluster</span> <span class="o">=</span> <span class="n">svd</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_normalisasi</span><span class="p">)</span>

<span class="c1"># Fuzzy C-Means Clustering</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fcm</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_cluster</span><span class="p">)</span>

<span class="c1"># Mendapatkan hasil clustering</span>
<span class="n">membership</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">u</span>
<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">membership</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Menentukan cluster untuk setiap data</span>

<span class="c1"># Create a new DataFrame with the cluster labels and index aligned with &#39;texts&#39;</span>
<span class="n">cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Cluster&#39;</span><span class="p">:</span> <span class="n">cluster_labels</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Merge the cluster labels back into the original DataFrame &#39;df&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cluster_df</span><span class="p">)</span>  <span class="c1"># Bergabung dengan df menggunakan join yang sesuai</span>
<span class="c1"># Tampilkan jumlah data pada setiap cluster</span>
<span class="n">cluster_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Tambahkan setelah cluster_labels dihasilkan</span>
<span class="n">silhouette_avg</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">data_cluster</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">silhouette_avg</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Cetak hasil jumlah data per cluster</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data pada setiap cluster:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cluster_counts</span><span class="p">)</span>

<span class="c1"># Visualisasi hasil clustering</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Plot titik data dalam ruang 2D yang sudah direduksi, dengan warna berdasarkan cluster</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_cluster</span><span class="p">[</span><span class="n">cluster_labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">data_cluster</span><span class="p">[</span><span class="n">cluster_labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cluster </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Plot centroid</span>
<span class="n">cluster_centers</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">centers</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cluster_centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">cluster_centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Centroids&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fuzzy C-Means Clustering of Text Data with SVD (n_clusters=</span><span class="si">{</span><span class="n">n_clusters</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;SVD Component 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;SVD Component 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Silhouette Score: 0.1035
Jumlah data pada setiap cluster:
Cluster
0    61
1    39
Name: count, dtype: int64
</pre></div>
</div>
<img alt="_images/96d336907a75db81bb04348199b23885ab34b28d2130cd5f700654558818c869.png" src="_images/96d336907a75db81bb04348199b23885ab34b28d2130cd5f700654558818c869.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menambahkan hasil klasterisasi ke dalam DataFrame</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cluster_labels</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fd75a533-5986-4330-89ed-3f7ddcb1f2c4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Judul Berita</th>
      <th>Isi Berita</th>
      <th>Tanggal Berita</th>
      <th>Kategori Berita</th>
      <th>cleansing</th>
      <th>case_folding</th>
      <th>tokenize</th>
      <th>stopword_removal</th>
      <th>kategori_encoded</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Pesan Anies ke Tom Lembong Tersangka Korupsi I...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>30-10-2024 05:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nEko Ar...</td>
      <td>reporter\nnovali panji nugroho\neditor\neko ar...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor eko ari w...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tom Lembong Tersangka Korupsi Impor Gula, Nama...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 23:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Profil Tom Lembong, Eks Mendag dan Co-Captain ...</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>29-10-2024 22:55</td>
      <td>Nasional</td>
      <td>Reporter\nNovali Panji Nugroho\nEditor\nAhmad ...</td>
      <td>reporter\nnovali panji nugroho\neditor\nahmad ...</td>
      <td>['reporter', 'novali', 'panji', 'nugroho', 'ed...</td>
      <td>reporter novali panji nugroho editor ahmad fai...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom Lembong Sempat Unggah Hal Ini Sehari Sebel...</td>
      <td>Reporter\nTempo.co\nEditor\nAndry Triyanto Tji...</td>
      <td>30-10-2024 02:55</td>
      <td>Nasional</td>
      <td>Reporter\nTempoco\nEditor\nAndry Triyanto Tjit...</td>
      <td>reporter\ntempoco\neditor\nandry triyanto tjit...</td>
      <td>['reporter', 'tempoco', 'editor', 'andry', 'tr...</td>
      <td>reporter tempoco editor andry triyanto tjitra ...</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prabowo Ingin Tingkatkan Pembangunan di Papua,...</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>29-10-2024 23:55</td>
      <td>Bisnis</td>
      <td>Reporter\nVedro Imanuel G\nEditor\nAgung Seday...</td>
      <td>reporter\nvedro imanuel g\neditor\nagung seday...</td>
      <td>['reporter', 'vedro', 'imanuel', 'g', 'editor'...</td>
      <td>reporter vedro imanuel g editor agung sedayu r...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Kementan Berencana Datangkan Sapi Hidup Ke Ind...</td>
      <td>Reporter\nM. Raihan Muzzaki\nEditor\nAisha Sha...</td>
      <td>30-10-2024 00:58</td>
      <td>Bisnis</td>
      <td>Reporter\nM Raihan Muzzaki\nEditor\nAisha Shai...</td>
      <td>reporter\nm raihan muzzaki\neditor\naisha shai...</td>
      <td>['reporter', 'm', 'raihan', 'muzzaki', 'editor...</td>
      <td>reporter m raihan muzzaki editor aisha shaidra...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Profil Charles Sitorus, Tersangka dalam Kasus ...</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr. Ariyani Y...</td>
      <td>30-10-2024 02:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAdil Al Hasan\nEditor\nRr Ariyani Ya...</td>
      <td>reporter\nadil al hasan\neditor\nrr ariyani ya...</td>
      <td>['reporter', 'adil', 'al', 'hasan', 'editor', ...</td>
      <td>reporter adil al hasan editor rr ariyani yakti...</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Bisik-bisik Prabowo kepada Fahri Hamzah Wakil ...</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS. Dian...</td>
      <td>30-10-2024 03:58</td>
      <td>Bisnis</td>
      <td>Reporter\nSukma Kanthi Nurani\nEditor\nS Dian ...</td>
      <td>reporter\nsukma kanthi nurani\neditor\ns dian ...</td>
      <td>['reporter', 'sukma', 'kanthi', 'nurani', 'edi...</td>
      <td>reporter sukma kanthi nurani editor s dian and...</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Tom Lembong Jadi Tersangka, Ini Kata Anies, Mu...</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu,...</td>
      <td>30-10-2024 10:58</td>
      <td>Bisnis</td>
      <td>Reporter\nAntara\nEditor\nYudono Yanuar\nRabu ...</td>
      <td>reporter\nantara\neditor\nyudono yanuar\nrabu ...</td>
      <td>['reporter', 'antara', 'editor', 'yudono', 'ya...</td>
      <td>reporter editor yudono yanuar rabu oktober wib...</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Kejagung Tetapkan Tom Lembong Tersangka Impor ...</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS. D...</td>
      <td>30-10-2024 13:58</td>
      <td>Bisnis</td>
      <td>Reporter\nRachel Farahdiba Regar\nEditor\nS Di...</td>
      <td>reporter\nrachel farahdiba regar\neditor\ns di...</td>
      <td>['reporter', 'rachel', 'farahdiba', 'regar', '...</td>
      <td>reporter rachel farahdiba regar editor s dian ...</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 10 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fd75a533-5986-4330-89ed-3f7ddcb1f2c4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fd75a533-5986-4330-89ed-3f7ddcb1f2c4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fd75a533-5986-4330-89ed-3f7ddcb1f2c4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-148be633-b1dc-48b1-96c2-6c18e2d7690e">
  <button class="colab-df-quickchart" onclick="quickchart('df-148be633-b1dc-48b1-96c2-6c18e2d7690e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-148be633-b1dc-48b1-96c2-6c18e2d7690e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_7be83898-9add-4bfe-b860-cd2b603f30f7">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_7be83898-9add-4bfe-b860-cd2b603f30f7 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Ambil kolom kategori dari dataframe sebagai label asli (true labels)</span>
<span class="n">true_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori_encoded&#39;</span><span class="p">]</span>  <span class="c1"># Ganti &#39;kategori&#39; dengan nama kolom kategori di DataFrame Anda</span>

<span class="c1"># Gunakan LabelEncoder untuk mengubah kategori menjadi angka</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">true_labels_encoded</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">true_labels</span><span class="p">)</span>

<span class="c1"># Hitung confusion matrix antara true labels dan hasil clustering</span>
<span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">true_labels_encoded</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

<span class="c1"># Tampilkan confusion matrix menggunakan heatmap untuk visualisasi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix (Contingency Matrix) between True Labels and Clustering&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cluster Labels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Labels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Cetak confusion matrix secara numerik</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix (Contingency Matrix):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conf_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9e0e68f6f9b93931bc993d4ddd5ea316c9c4903fd5af7bcbcc41e9c5356883cc.png" src="_images/9e0e68f6f9b93931bc993d4ddd5ea316c9c4903fd5af7bcbcc41e9c5356883cc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix (Contingency Matrix):
[[32 18]
 [29 21]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tambahkan kolom ID jika belum ada</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Ambil kolom id, kategori_encoded, dan Cluster</span>
<span class="n">selected_columns</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;kategori_encoded&#39;</span><span class="p">,</span> <span class="s1">&#39;Cluster&#39;</span><span class="p">]]</span>

<span class="c1"># Tampilkan DataFrame yang hanya berisi kolom yang dipilih</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selected_columns</span><span class="p">)</span>

<span class="c1"># Ambil semua anggota Cluster 0</span>
<span class="n">cluster_0</span> <span class="o">=</span> <span class="n">selected_columns</span><span class="p">[</span><span class="n">selected_columns</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Ambil semua anggota Cluster 1</span>
<span class="n">cluster_1</span> <span class="o">=</span> <span class="n">selected_columns</span><span class="p">[</span><span class="n">selected_columns</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Tampilkan hasil dalam bentuk list</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anggota Cluster 0:&quot;</span><span class="p">,</span> <span class="n">cluster_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anggota Cluster 1:&quot;</span><span class="p">,</span> <span class="n">cluster_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    id  kategori_encoded  Cluster
0    0                 1        0
1    1                 1        0
2    2                 1        0
3    3                 1        0
4    4                 0        1
..  ..               ...      ...
95  95                 0        1
96  96                 0        0
97  97                 0        1
98  98                 0        0
99  99                 0        0

[100 rows x 3 columns]
Anggota Cluster 0: [0, 1, 2, 3, 7, 8, 10, 11, 14, 16, 17, 19, 20, 21, 22, 23, 27, 28, 30, 31, 34, 35, 38, 39, 40, 41, 42, 43, 47, 48, 50, 51, 54, 55, 58, 59, 60, 61, 62, 63, 67, 68, 70, 71, 74, 75, 78, 79, 80, 81, 82, 83, 87, 88, 90, 91, 92, 93, 96, 98, 99]
Anggota Cluster 1: [4, 5, 6, 9, 12, 13, 15, 18, 24, 25, 26, 29, 32, 33, 36, 37, 44, 45, 46, 49, 52, 53, 56, 57, 64, 65, 66, 69, 72, 73, 76, 77, 84, 85, 86, 89, 94, 95, 97]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Mengonversi keanggotaan fuzzy menjadi label cluster dengan memilih cluster dengan membership tertinggi</span>
<span class="n">fuzzy_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">membership</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Menghitung Silhouette Score</span>
<span class="n">silhouette_avg</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">data_cluster</span><span class="p">,</span> <span class="n">fuzzy_labels</span><span class="p">)</span>

<span class="c1"># Menampilkan Silhouette Score</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">silhouette_avg</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Silhouette Score: 0.1035
</pre></div>
</div>
</div>
</div>
</section>
<section id="penyimpanan-hasil">
<h2>Penyimpanan Hasil<a class="headerlink" href="#penyimpanan-hasil" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">FunctionTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Membaca datadf =</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;kategori_encoded_data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>  <span class="c1"># Pastikan data berupa string</span>

<span class="c1"># Fungsi untuk menerapkan FCM dalam pipeline</span>
<span class="k">def</span> <span class="nf">fit_fcm</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">fcm</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span>
        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>         <span class="c1"># Jumlah cluster yang diinginkan</span>
        <span class="n">m</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>                <span class="c1"># Fuzziness coefficient</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>        <span class="c1"># Maksimal iterasi</span>
        <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>        <span class="c1"># Toleransi konvergensi</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>       <span class="c1"># Menetapkan seed untuk random state</span>
    <span class="p">)</span>
    <span class="n">fcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fcm</span>

<span class="c1"># Fungsi pembungkus untuk FCM (untuk FunctionTransformer)</span>
<span class="k">def</span> <span class="nf">fit_fcm_wrapper</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fit_fcm</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Tuning parameter TfidfVectorizer</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;tfidf&#39;</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">max_df</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_mean</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;svd&#39;</span><span class="p">,</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">20</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;fcm&#39;</span><span class="p">,</span> <span class="n">FunctionTransformer</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">fit_fcm_wrapper</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Fit pipeline pada data pelatihan</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Simpan pipeline yang telah dilatih</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="s1">&#39;svd_tfidf_scaler_fcm_pipeline.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;svd_tfidf_scaler_fcm_pipeline.pkl&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">fcmeans</span> <span class="kn">import</span> <span class="n">FCM</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># 1. Memuat pipeline yang sudah dilatih sebelumnya</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;svd_tfidf_scaler_fcm_pipeline.pkl&#39;</span><span class="p">)</span>

<span class="c1"># 2. Melakukan FCM pada data pelatihan (sudah dilabeli Games dan Sepakbola)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;kategori_encoded_data.csv&quot;</span><span class="p">)</span>
<span class="c1"># Mengatasi nilai NaN dalam kolom &#39;stopword_removal&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Mengganti NaN dengan string kosong</span>
<span class="n">data_pelatihan</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;stopword_removal&#39;</span><span class="p">]</span>

<span class="c1"># Transformasi data pelatihan menggunakan pipeline</span>
<span class="n">X_train_transformed</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_pelatihan</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X_train_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
    <span class="n">X_train_transformed</span> <span class="o">=</span> <span class="n">X_train_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="c1"># 3. Melakukan clustering FCM pada data pelatihan</span>
<span class="n">fcm_model</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fcm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_transformed</span><span class="p">)</span>

<span class="c1"># 4. Menyelaraskan cluster dengan label yang diketahui</span>
<span class="n">labels_train</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;kategori_encoded&#39;</span><span class="p">]</span>

<span class="c1"># Menyelaraskan cluster dengan label</span>
<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">fcm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_transformed</span><span class="p">)</span>
<span class="n">cluster_to_label</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Bisnis&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Nasional&#39;</span><span class="p">}</span> <span class="c1">#0: &#39;Otomotif&#39;, 1: &#39;Keuangan&#39; dan #0: &#39;Keuangan&#39;, 1: &#39;Otomotif&#39;</span>

<span class="c1"># Menyelaraskan prediksi cluster dengan label</span>
<span class="n">predicted_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">cluster_to_label</span><span class="p">[</span><span class="n">cluster</span><span class="p">]</span> <span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="p">]</span>

<span class="c1"># 5. Memuat data baru untuk prediksi</span>
<span class="n">teks_baru</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Perekonomian Indonesia mencatatkan pertumbuhan yang pesat pada kuartal ketiga tahun 2024, dengan angka pertumbuhan ekonomi mencapai 5,2%. Angka ini menunjukkan pemulihan yang signifikan setelah mengalami penurunan akibat pandemi COVID-19 pada tahun-tahun sebelumnya. Pertumbuhan ini didorong oleh sektor manufaktur, yang mengalami lonjakan permintaan baik di pasar domestik maupun internasional.&quot;&quot;&quot;</span>

<span class="c1"># Transformasi data baru menggunakan pipeline</span>
<span class="n">X_new_transformed</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">teks_baru</span><span class="p">])</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X_new_transformed</span><span class="p">,</span> <span class="s1">&#39;toarray&#39;</span><span class="p">):</span>
    <span class="n">X_new_transformed</span> <span class="o">=</span> <span class="n">X_new_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="c1"># 6. Prediksi cluster untuk data baru</span>
<span class="n">cluster_new</span> <span class="o">=</span> <span class="n">fcm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new_transformed</span><span class="p">)</span>

<span class="c1"># Menyelaraskan prediksi cluster dengan label</span>
<span class="n">predicted_label_new</span> <span class="o">=</span> <span class="n">cluster_to_label</span><span class="p">[</span><span class="n">cluster_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1"># 7. Menampilkan hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Teks baru ini diprediksi ke dalam cluster: </span><span class="si">{</span><span class="n">predicted_label_new</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Teks baru ini diprediksi ke dalam cluster: Nasional
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fcmeans</span> <span class="kn">import</span> <span class="n">FCM</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">joblib</span>

<span class="c1"># Fungsi untuk menerapkan FCM</span>
<span class="k">def</span> <span class="nf">fit_fcm</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">fcm</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span>
        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">m</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>
    <span class="n">fcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fcm</span>

<span class="c1"># Pipeline tanpa FCM</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;tfidf&#39;</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">()),</span>  <span class="c1"># TF-IDF untuk teks</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="n">with_mean</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>  <span class="c1"># Normalisasi data</span>
    <span class="p">(</span><span class="s1">&#39;svd&#39;</span><span class="p">,</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># Reduksi Dimensi</span>
<span class="p">])</span>

<span class="c1"># Fit pipeline pada data</span>
<span class="n">transformed_data</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Pastikan &#39;data&#39; sudah diproses sebelumnya</span>

<span class="c1"># Jalankan FCM pada data yang sudah diproses</span>
<span class="n">fcm_result</span> <span class="o">=</span> <span class="n">fit_fcm</span><span class="p">(</span><span class="n">transformed_data</span><span class="p">)</span>

<span class="c1"># Simpan pipeline dan hasil FCM dalam satu file (tuple)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">fcm_result</span><span class="p">),</span> <span class="s1">&#39;model_fuzzy_cmeans.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;model_fuzzy_cmeans.pkl&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tugas6new.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">tahap evaluasi model</p>
      </div>
    </a>
    <a class="right-next"
       href="deploy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tugas Deploy Aplikasi</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#menerapkan-vektorisasi-tf-idf">Menerapkan Vektorisasi TF-IDF :</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mencari-jumlah-komponen-terbaik-n-components">mencari jumlah komponen terbaik (n_components)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-c-means-clustering">Fuzzy C-Means Clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi">Visualisasi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#penyimpanan-hasil">Penyimpanan Hasil</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>